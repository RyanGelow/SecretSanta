<html>
	<head>
			<title>Secret Santa</title>
			<style>
          body {
              font-family: Arial, sans-serif;
              background: #f5f5f5;
              margin: 0;
              padding: 20px;
          }
          .selections {
              display: flex;
              flex-direction: column;
              min-height: 100vh;
              width: 100%;
              justify-content: center;
              align-items: center;
          }
          .container {
              background: white;
              padding: 40px;
              border-radius: 10px;
              box-shadow: 0 4px 6px rgba(0,0,0,0.1);
              max-width: 500px;
              width: 100%;
          }
          h1 {
              color: #721817;
              text-align: center;
              margin-bottom: 30px;
          }
          button {
              background: #721817;
              color: white;
              border: none;
              padding: 15px 30px;
              font-size: 16px;
              border-radius: 5px;
              cursor: pointer;
              width: 100%;
              margin-bottom: 20px;
          }
          button:hover {
              background: #5a1312;
          }
          .assignments {
              margin-top: 20px;
          }
          .assignment {
              background: #f9f9f9;
              padding: 15px;
              margin-bottom: 10px;
              border-radius: 5px;
              border-left: 4px solid #721817;
          }
          .giver {
              font-weight: bold;
              color: #721817;
          }
          .receiver {
              color: #333;
              margin-top: 5px;
          }
          .error {
              background: #ffe6e6;
              color: #c00;
              padding: 15px;
              border-radius: 5px;
              border-left: 4px solid #c00;
              margin-top: 20px;
          }
			</style>
	</head>
	<body>
		<h1>üéÅ Gelow Fam Secret Santa Generator</h1>
		<button onclick="generateAssignments()">Generate Assignments</button>
		<div id="results"></div>
		<script>
			const people = [
				{
					id: 1,
					name: "Mark",
					exclude: [2]
				},
				{
					id: 2,
					name: "Sara",
					exclude: [1]
				},
				{
					id: 3,
					name: "Ryan",
					exclude: [4]
				},
				{
					id: 4,
					name: "Holly",
					exclude: [3]
				},
				{
					id: 5,
					name: "Chelsey",
					exclude: [6]
				},
				{
					id: 6,
					name: "Lance",
					exclude: [5]
				},
			];
			function shuffleArray(array) {
				const shuffled = [...array];
				for (let i = shuffled.length - 1; i > 0; i--) {
					const j = Math.floor(Math.random() * (i + 1));
					[shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
				}
				return shuffled;
			}

			function isValidAssignment(giver, receiver) {
				// Can't give to yourself
				if (giver.id === receiver.id) return false;

				// Can't give to excluded people
				if (giver.exclude && giver.exclude.includes(receiver.id)) return false;

				return true;
			}

			function generateAssignments() {
				const maxAttempts = 1000;
				let attempts = 0;
				let validAssignment = null;

				while (attempts < maxAttempts) {
					attempts++;
					const shuffledReceivers = shuffleArray([...people]);
					const assignments = [];
					let isValid = true;

					for (let i = 0; i < people.length; i++) {
						const giver = people[i];
						const receiver = shuffledReceivers[i];

						if (!isValidAssignment(giver, receiver)) {
							isValid = false;
							break;
						}

						assignments.push({
							giver: giver,
							receiver: receiver
						});
					}

					if (isValid) {
						validAssignment = assignments;
						break;
					}
				}

				displayResults(validAssignment, attempts);
			}

			function displayResults(assignments, attempts) {
				const resultsDiv = document.getElementById('results');

				if (!assignments) {
					resultsDiv.innerHTML = `
         <div class="error">
           <strong>Error:</strong> Could not generate valid assignments after ${attempts} attempts.
           The exclusion rules might be too restrictive.
         </div>
       `;
					return;
				}

				let html = '<div class="assignments">';
				html += `<p style="text-align: center; color: #666; margin-bottom: 15px;">Generated in ${attempts} attempt(s)</p>`;

				assignments.forEach(assignment => {
					html += `
         <div class="assignment">
           <div class="giver">${assignment.giver.name}</div>
           <div class="receiver">‚Üí gives to ${assignment.receiver.name}</div>
         </div>
       `;
				});

				html += '</div>';
				resultsDiv.innerHTML = html;
			}
		</script>
	</body>
</html>